<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:Shoppilar.Mobile.Shells.Auth.ViewModels"
             xmlns:behaviors="clr-namespace:Shoppilar.Mobile.Behaviors"
             x:Class="Shoppilar.Mobile.Shells.Auth.Views.RegisterView"
             x:DataType="vm:RegisterViewModel"
             Shell.NavBarIsVisible="False">

    <Grid Padding="25">

        <ScrollView x:Name="FormContainer" Opacity="1" TranslationX="0">
            <VerticalStackLayout Spacing="12" VerticalOptions="Center">
                <Label Text="Crie sua conta"
                       FontSize="24"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       Margin="0,0,0,10" />

                <Entry Placeholder="Nome completo"
                       Text="{Binding Input.PersonInput.Name}" />

                <Grid>
                    <Entry Placeholder="Nascimento"
                           IsReadOnly="True"
                           Text="{Binding BirthDisplay}" />

                    <DatePicker x:Name="BirthPicker"
                                Date="{Binding Input.PersonInput.Birth}"
                                IsVisible="False"
                                DateSelected="BirthPicker_DateSelected" />

                    <Button BackgroundColor="Transparent"
                            Clicked="OnPickDateClicked" />
                </Grid>


                <Entry Placeholder="Usuário"
                       Text="{Binding Input.UserName}" />

                <Entry Placeholder="Celular"
                       Text="{Binding Input.PhoneNumber}"
                       Keyboard="Telephone">
                    <Entry.Behaviors>
                        <behaviors:PhoneMaskBehavior />
                    </Entry.Behaviors>
                </Entry>

                <Entry Placeholder="E-mail"
                       Text="{Binding Input.Email}"
                       Keyboard="Email">
                    <Entry.Behaviors>
                        <behaviors:EmailNormalizeBehavior />
                    </Entry.Behaviors>
                </Entry>

                <Entry Placeholder="Senha"
                       Text="{Binding Input.Password}"
                       IsPassword="True" />

                <Entry Placeholder="Confirmar senha"
                       Text="{Binding ConfirmPassword}"
                       IsPassword="True" />

                <Button Text="Continue"
                        Command="{Binding ContinueCommand}"
                        BackgroundColor="#007BFF"
                        TextColor="White"
                        CornerRadius="8"
                        Margin="0,20,0,0" />

                <Button Text="Voltar"
                        Command="{Binding GoToLoginCommand}"
                        BackgroundColor="Transparent"
                        TextColor="#007BFF"
                        CornerRadius="8"
                        HeightRequest="40" />
            </VerticalStackLayout>
        </ScrollView>

        <Grid x:Name="CodeContainer"
              Opacity="0"
              TranslationX="400">
            <VerticalStackLayout Spacing="20" VerticalOptions="CenterAndExpand">
                <Label Text="Digite o código de 6 dígitos"
                       FontSize="18"
                       HorizontalOptions="Center" />

                <HorizontalStackLayout HorizontalOptions="Center" Spacing="8">
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code1Entry" Text="{Binding Code1}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code2Entry" Text="{Binding Code2}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code3Entry" Text="{Binding Code3}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code4Entry" Text="{Binding Code4}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code5Entry" Text="{Binding Code5}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code6Entry" Text="{Binding Code6}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                </HorizontalStackLayout>

                <Button Text="Verificar código"
                        Command="{Binding VerifyCodeCommand}"
                        BackgroundColor="#007BFF"
                        TextColor="White"
                        CornerRadius="8" />

                <Button Text="Voltar"
                        Command="{Binding GoBackCommand}"
                        BackgroundColor="Transparent"
                        TextColor="#007BFF" />
            </VerticalStackLayout>
        </Grid>

        <Grid x:Name="SuccessContainer"
              Opacity="0"
              TranslationX="400">
            <VerticalStackLayout VerticalOptions="CenterAndExpand" Spacing="20">
                <Image Source="success.png"
                       HorizontalOptions="Center" 
                       HeightRequest="200"
                       Aspect="AspectFit" />

                <Label Text="Bem-vindo à Shoppilar. Agora você pode acessar sua conta!"
                       FontSize="15"
                       HorizontalOptions="Center"
                       TextColor="#666"
                       HorizontalTextAlignment="Center" />

                <Button Text="OK"
                        Command="{Binding GoToLoginCommand}"
                        BackgroundColor="#007BFF"
                        TextColor="White"
                        CornerRadius="8"/>
            </VerticalStackLayout>
        </Grid>

    </Grid>
</ContentPage>