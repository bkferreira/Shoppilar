<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:Shoppilar.Mobile.Shells.Auth.ViewModels"
             xmlns:components="clr-namespace:Shoppilar.Mobile.Components"
             xmlns:behaviors="clr-namespace:Shoppilar.Mobile.Behaviors"
             x:Class="Shoppilar.Mobile.Shells.Auth.Views.ForgotPasswordView"
             x:DataType="vm:ForgotPasswordViewModel"
             Shell.NavBarIsVisible="False">

    <Grid Padding="25">

        <Grid x:Name="Step1Container" Opacity="1" TranslationX="0">
            <VerticalStackLayout Spacing="20" VerticalOptions="CenterAndExpand">

                <Label Text="Recupere sua senha"
                       FontSize="24"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       Margin="0,0,0,10" />

                <Label Text="Entre com o número de celular da sua conta para receber um código de verificação."
                       FontSize="14"
                       HorizontalOptions="Center"
                       HorizontalTextAlignment="Center"
                       TextColor="{AppThemeBinding Light=#666, Dark=#aaa}" />

                <components:FloatingEntryView
                    Label="Celular"
                    Text="{Binding Input.PhoneNumber, Mode=TwoWay}"
                    Keyboard="Telephone">
                    <components:FloatingEntryView.InputBehaviors>
                        <behaviors:PhoneMaskBehavior />
                    </components:FloatingEntryView.InputBehaviors>
                </components:FloatingEntryView>

                <Button Text="Enviar código"
                        Command="{Binding SendCodeCommand}"
                        BackgroundColor="#255E77"
                        TextColor="White"
                        CornerRadius="8"
                        HeightRequest="45" />

                <Button Text="Voltar"
                        Command="{Binding GoToLoginCommand}"
                        BackgroundColor="Transparent"
                        TextColor="#255E77"
                        HeightRequest="40" />
            </VerticalStackLayout>
        </Grid>

        <Grid x:Name="Step2Container"
              Opacity="0"
              TranslationX="400">
            <VerticalStackLayout Spacing="20" VerticalOptions="CenterAndExpand">
                <Label Text="Digite o código de 6 dígitos"
                       FontSize="18"
                       HorizontalOptions="Center" />

                <HorizontalStackLayout HorizontalOptions="Center" Spacing="8">
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code1Entry" Text="{Binding Code1}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code2Entry" Text="{Binding Code2}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code3Entry" Text="{Binding Code3}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code4Entry" Text="{Binding Code4}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code5Entry" Text="{Binding Code5}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                    <Border StrokeShape="RoundRectangle 10" HeightRequest="40" WidthRequest="40">
                        <Entry x:Name="Code6Entry" Text="{Binding Code6}" MaxLength="1" Keyboard="Numeric"
                               HorizontalTextAlignment="Center" />
                    </Border>
                </HorizontalStackLayout>

                <Button Text="Verificar código"
                        Command="{Binding VerifyCodeCommand}"
                        BackgroundColor="#255E77"
                        TextColor="White"
                        CornerRadius="8" />

                <Button Text="Voltar"
                        Command="{Binding GoBackCommand}"
                        BackgroundColor="Transparent"
                        TextColor="#255E77" />
            </VerticalStackLayout>
        </Grid>

        <Grid x:Name="Step3Container"
              Opacity="0"
              TranslationX="{OnPlatform iOS=400, Android=400, WinUI=400}">
            <VerticalStackLayout Spacing="20" VerticalOptions="CenterAndExpand">
                <Label Text="Defina uma nova senha"
                       FontSize="22"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       Margin="0,0,0,10" />

                <Label Text="Digite sua nova senha abaixo."
                       FontSize="14"
                       HorizontalOptions="Center"
                       HorizontalTextAlignment="Center"
                       TextColor="{AppThemeBinding Light=#666, Dark=#aaa}" />

                <components:FloatingEntryView
                    Label="Nova senha"
                    Text="{Binding Input.NewPassword, Mode=TwoWay}"
                    IsPassword="True"
                    Keyboard="Text" />

                <components:FloatingEntryView
                    Label="Confirmar senha"
                    Text="{Binding ConfirmPassword, Mode=TwoWay}"
                    IsPassword="True"
                    Keyboard="Text" />


                <Button Text="Alterar a senha"
                        Command="{Binding ChangePasswordCommand}"
                        BackgroundColor="#255E77"
                        TextColor="White"
                        CornerRadius="8"
                        HeightRequest="45" />

                <Button Text="Voltar"
                        Command="{Binding GoBackToCodeCommand}"
                        BackgroundColor="Transparent"
                        TextColor="#255E77" />
            </VerticalStackLayout>
        </Grid>

        <Grid x:Name="Step4Container"
              Opacity="0"
              TranslationX="400">
            <VerticalStackLayout VerticalOptions="CenterAndExpand" Spacing="20">
                <Image Source="success.png"
                       Aspect="AspectFit"
                       HeightRequest="200"
                       HorizontalOptions="Center" />

                <Label Text="Agora você pode efetuar login com sua nova senha."
                       FontSize="15"
                       HorizontalOptions="Center"
                       TextColor="#666"
                       HorizontalTextAlignment="Center" />

                <Button Text="OK"
                        Command="{Binding GoToLoginCommand}"
                        BackgroundColor="#255E77"
                        TextColor="White"
                        CornerRadius="8" />
            </VerticalStackLayout>
        </Grid>

    </Grid>
</ContentPage>